{"paragraphs":[{"text":"%md\n\n## **MovieLens 100K Dataset Analysis with Cassandra and Spark**\n\nMovieLens data sets were collected by the GroupLens Research Project at the University of Minnesota.\n \nThis data set consists of 100,000 ratings (1-5) from 943 users on 1682 movies and each user has rated at least 20 movies.It contains simple demographic info for the users (age, gender, occupation, zip)\n\n\nThe project aims to use Cassandra Query Language (CQL) and Spark2 Structured Query Language (SQL) to analyze the user info from the datasets to answer following questions:\n    1. Calculate the average rating for each movie.\n    2. Identify the top ten movies with the highest average ratings.\n    3. Find the users who have rated at least 50 movies and identify their favourite movie genres.\n    4. Find all the users who are less than 20 years old.\n    5. Find all the users whose occupation is “scientist” and whose age is between 30 and 40 years old.\n\nThis anlaysis uses Docker to run Zeppelin and Cassandra","user":"anonymous","dateUpdated":"2025-08-06T05:18:12+0000","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2><strong>MovieLens 100K Dataset Analysis with Cassandra and Spark</strong></h2>\n<p>MovieLens data sets were collected by the GroupLens Research Project at the University of Minnesota.</p>\n<p>This data set consists of 100,000 ratings (1-5) from 943 users on 1682 movies and each user has rated at least 20 movies.It contains simple demographic info for the users (age, gender, occupation, zip)</p>\n<p>The project aims to use Cassandra Query Language (CQL) and Spark2 Structured Query Language (SQL) to analyze the user info from the datasets to answer following questions:<br />\n1. Calculate the average rating for each movie.<br />\n2. Identify the top ten movies with the highest average ratings.<br />\n3. Find the users who have rated at least 50 movies and identify their favourite movie genres.<br />\n4. Find all the users who are less than 20 years old.<br />\n5. Find all the users whose occupation is “scientist” and whose age is between 30 and 40 years old.</p>\n<p>This anlaysis uses Docker to run Zeppelin and Cassandra</p>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1754455203364_1021404811","id":"20250803-101857_23535766","dateCreated":"2025-08-06T04:40:03+0000","dateStarted":"2025-08-06T05:18:12+0000","dateFinished":"2025-08-06T05:18:12+0000","status":"FINISHED","focus":true},{"text":"%md\n\n### 1. Setting up the Docker\n\na. Create a Docker network\n\n```shell\ndocker network create zeppelin-net\n```\nb. Start Cassandra container\n\n```shell\ndocker network create zeppelin-net\n```\nc. Start Zeppeling container\n\n```bash\ndocker run -d --name zeppelin --network zeppelin-net -p 9090:8080 apache/zeppelin:0.12.0\n```\n\nd. Install Spark in Zeppelin container\n\n```bash\ndocker exec -it zeppelin bash\n\ncd /tmp\n\nwget https://archive.apache.org/dist/spark/spark-3.1.2/spark-3.1.2-bin-hadoop3.2.tgz\n\ntar -xvzf spark-3.1.2-bin-hadoop3.2.tgz\n```\ne. Reconfigure the interpreter\n\n    SPARK_HOME -> /tmp/spark-3.1.2-bin-hadoop3.2\n    spark.master -> local[*]\n    spark.cassandra.connection.host -> Cassandra\n    spark.jars.packages -> com.datastax.spark:spark-cassandra-connector_2.12:3.1.0\n    zeppeline.spark.enableSupportVersionCheck -> false\n\n\n\n","user":"anonymous","dateUpdated":"2025-08-06T05:18:12+0000","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>1. Setting up the Docker</h3>\n<p>a. Create a Docker network</p>\n<pre><code class=\"language-shell\">docker network create zeppelin-net\n</code></pre>\n<p>b. Start Cassandra container</p>\n<pre><code class=\"language-shell\">docker network create zeppelin-net\n</code></pre>\n<p>c. Start Zeppeling container</p>\n<pre><code class=\"language-bash\">docker run -d --name zeppelin --network zeppelin-net -p 9090:8080 apache/zeppelin:0.12.0\n</code></pre>\n<p>d. Install Spark in Zeppelin container</p>\n<pre><code class=\"language-bash\">docker exec -it zeppelin bash\n\ncd /tmp\n\nwget https://archive.apache.org/dist/spark/spark-3.1.2/spark-3.1.2-bin-hadoop3.2.tgz\n\ntar -xvzf spark-3.1.2-bin-hadoop3.2.tgz\n</code></pre>\n<p>e. Reconfigure the interpreter</p>\n<pre><code>SPARK_HOME -&gt; /tmp/spark-3.1.2-bin-hadoop3.2\nspark.master -&gt; local[*]\nspark.cassandra.connection.host -&gt; Cassandra\nspark.jars.packages -&gt; com.datastax.spark:spark-cassandra-connector_2.12:3.1.0\nzeppeline.spark.enableSupportVersionCheck -&gt; false\n</code></pre>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1754455203365_1489569975","id":"20250803-101819_572287558","dateCreated":"2025-08-06T04:40:03+0000","dateStarted":"2025-08-06T05:18:12+0000","dateFinished":"2025-08-06T05:18:12+0000","status":"FINISHED"},{"text":"%md\n\n\n### 2. Uploading files from local into Zeppelin\n\n```bash\ndocker cp \"C:\\Users\\hajar\\Downloads\\ml-100k\\u.user\" zeppelin:/tmp/u.user\n\ndocker cp \"C:\\Users\\hajar\\Downloads\\Assignemnt_3\\ml-100k\\u.data\" zeppelin:/tmp/u.data\n\ndocker cp \"C:\\Users\\hajar\\Downloads\\Assignment_3\\ml-100k\\u.item\" zeppelin:/tmp/u.item\n```\n","user":"anonymous","dateUpdated":"2025-08-06T05:18:12+0000","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>2. Uploading files from local into Zeppelin</h3>\n<pre><code class=\"language-bash\">docker cp &quot;C:\\Users\\hajar\\Downloads\\ml-100k\\u.user&quot; zeppelin:/tmp/u.user\n\ndocker cp &quot;C:\\Users\\hajar\\Downloads\\Assignemnt_3\\ml-100k\\u.data&quot; zeppelin:/tmp/u.data\n\ndocker cp &quot;C:\\Users\\hajar\\Downloads\\Assignment_3\\ml-100k\\u.item&quot; zeppelin:/tmp/u.item\n</code></pre>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1754455203365_1065052255","id":"20250805-143324_1870138663","dateCreated":"2025-08-06T04:40:03+0000","dateStarted":"2025-08-06T05:18:12+0000","dateFinished":"2025-08-06T05:18:12+0000","status":"FINISHED"},{"text":"%md\n\n### 3. Create keyspaces and tables in Cassandra\n\nIn Cassandra Shell\n\n```bash\ndocker exec -it cassandra cqlsh\n```\n\na) Create the keyspace\n\n```{shell}\nCREATE KEYSPACE movielens\nWITH replication = {'class': 'SimpleStrategy', 'replication_factor': 1};\n\nUSE movielens;\n```\n\nb) Create the tables\n\n```{shell}\n\nCREATE TABLE users (\n  user_id int PRIMARY KEY,\n  age int,\n  gender text,\n  occupation text,\n  zip_code text\n);\n\nCREATE TABLE ratings (\n    user_id int,\n    movie_id int,\n    rating int,\n    timestamp bigint,\n    PRIMARY KEY (user_id, movie_id)\n);\n\nCREATE TABLE titles (\n  movie_id int PRIMARY KEY,\n  title text,\n  release_date text,\n  imdb_url text,\n  unknown int,\n  action int,\n  adventure int,\n  animation int,\n  children int,\n  comedy int,\n  crime int,\n  documentary int,\n  drama int,\n  fantasy int,\n  film_noir int,\n  horror int,\n  musical int,\n  mystery int,\n  romance int,\n  sci_fi int,\n  thriller int,\n  war int,\n  western int\n);\n```","user":"anonymous","dateUpdated":"2025-08-06T05:18:12+0000","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>3. Create keyspaces and tables in Cassandra</h3>\n<p>In Cassandra Shell</p>\n<pre><code class=\"language-bash\">docker exec -it cassandra cqlsh\n</code></pre>\n<p>a) Create the keyspace</p>\n<pre><code class=\"language-{shell}\">CREATE KEYSPACE movielens\nWITH replication = {'class': 'SimpleStrategy', 'replication_factor': 1};\n\nUSE movielens;\n</code></pre>\n<p>b) Create the tables</p>\n<pre><code class=\"language-{shell}\">\nCREATE TABLE users (\n  user_id int PRIMARY KEY,\n  age int,\n  gender text,\n  occupation text,\n  zip_code text\n);\n\nCREATE TABLE ratings (\n    user_id int,\n    movie_id int,\n    rating int,\n    timestamp bigint,\n    PRIMARY KEY (user_id, movie_id)\n);\n\nCREATE TABLE titles (\n  movie_id int PRIMARY KEY,\n  title text,\n  release_date text,\n  imdb_url text,\n  unknown int,\n  action int,\n  adventure int,\n  animation int,\n  children int,\n  comedy int,\n  crime int,\n  documentary int,\n  drama int,\n  fantasy int,\n  film_noir int,\n  horror int,\n  musical int,\n  mystery int,\n  romance int,\n  sci_fi int,\n  thriller int,\n  war int,\n  western int\n);\n</code></pre>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1754455203365_154948446","id":"20250803-101542_897230084","dateCreated":"2025-08-06T04:40:03+0000","dateStarted":"2025-08-06T05:18:12+0000","dateFinished":"2025-08-06T05:18:12+0000","status":"FINISHED"},{"text":"%pyspark\n\n#test Spark\nspark.range(1).show()","user":"anonymous","dateUpdated":"2025-08-06T05:18:12+0000","progress":0,"config":{"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+\n| id|\n+---+\n|  0|\n+---+\n\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://f1fd28cdfb38:4040/jobs/job?id=83"},{"jobUrl":"http://f1fd28cdfb38:4040/jobs/job?id=84"},{"jobUrl":"http://f1fd28cdfb38:4040/jobs/job?id=85"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1754455203366_1935370397","id":"20250803-112216_110772066","dateCreated":"2025-08-06T04:40:03+0000","dateStarted":"2025-08-06T05:18:12+0000","dateFinished":"2025-08-06T05:18:13+0000","status":"FINISHED"},{"text":"%md\n\n### 4. Loading data from Zeppelin and write into Cassandra. \n\nHere we create RDD (Resilient Distributed Dataset) objects","user":"anonymous","dateUpdated":"2025-08-06T05:18:13+0000","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>4. Loading data from Zeppelin and write into Cassandra.</h3>\n<p>Here we create RDD (Resilient Distributed Dataset) objects</p>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1754455203366_2063793243","id":"20250803-102629_1731167397","dateCreated":"2025-08-06T04:40:03+0000","dateStarted":"2025-08-06T05:18:13+0000","dateFinished":"2025-08-06T05:18:13+0000","status":"FINISHED"},{"text":"%pyspark\n\n#libraries\n\nfrom pyspark.sql import Row\nfrom pyspark.sql import functions as F","user":"anonymous","dateUpdated":"2025-08-06T05:18:13+0000","progress":0,"config":{"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1754455203366_1611990294","id":"20250804-115353_727784478","dateCreated":"2025-08-06T04:40:03+0000","dateStarted":"2025-08-06T05:18:13+0000","dateFinished":"2025-08-06T05:18:13+0000","status":"FINISHED"},{"text":"%md\n\n#### **User Data**\n","user":"anonymous","dateUpdated":"2025-08-06T05:18:13+0000","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h4><strong>User Data</strong></h4>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1754455203366_84209856","id":"20250804-111938_634503936","dateCreated":"2025-08-06T04:40:03+0000","dateStarted":"2025-08-06T05:18:13+0000","dateFinished":"2025-08-06T05:18:13+0000","status":"FINISHED"},{"text":"%pyspark\n\n\n#to parse function \ndef parseInput(line):\n    x = line.split('|') # the delimiter used is pipe\n    return Row(user_id=int(x[0]), age=int(x[1]), gender=x[2], occupation=x[3], zip_code=x[4])\n\n# Load raw u.user file\nlines = spark.sparkContext.textFile(\"file:///tmp/u.user\") \n\n# Apply transformation\nusers = lines.map(parseInput)\n\n# Create DataFrame\nusersDataset = spark.createDataFrame(users)\n\n# Write to Cassandra\nusersDataset.write.format(\"org.apache.spark.sql.cassandra\") \\\n     .mode(\"append\") \\\n     .options(table=\"users\", keyspace=\"movielens\").save()\n\n# Read back from Cassandra\nreadUsers = spark.read.format(\"org.apache.spark.sql.cassandra\").options(table=\"users\", keyspace=\"movielens\").load()\n\nreadUsers.show()","user":"anonymous","dateUpdated":"2025-08-06T05:18:13+0000","progress":0,"config":{"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+---+------+-------------+--------+\n|user_id|age|gender|   occupation|zip_code|\n+-------+---+------+-------------+--------+\n|    885| 30|     F|        other|   95316|\n|    791| 31|     M|     educator|   20064|\n|    176| 28|     M|    scientist|   07030|\n|    393| 19|     M|      student|   83686|\n|    582| 17|     M|      student|   93003|\n|    371| 36|     M|     engineer|   99206|\n|    561| 23|     M|     engineer|   60005|\n|     89| 43|     F|administrator|   68106|\n|     78| 26|     M|administrator|   61801|\n|    265| 26|     M|    executive|   84601|\n|    216| 22|     M|     engineer|   02215|\n|    243| 33|     M|     educator|   60201|\n|    674| 13|     F|      student|   55337|\n|    111| 57|     M|     engineer|   90630|\n|     72| 48|     F|administrator|   73034|\n|    234| 60|     M|      retired|   94702|\n|    293| 24|     M|       writer|   60804|\n|    610| 22|     M|      student|   21227|\n|    452| 35|     M|administrator|   28018|\n|     31| 24|     M|       artist|   10003|\n+-------+---+------+-------------+--------+\nonly showing top 20 rows\n\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://f1fd28cdfb38:4040/jobs/job?id=86"},{"jobUrl":"http://f1fd28cdfb38:4040/jobs/job?id=87"},{"jobUrl":"http://f1fd28cdfb38:4040/jobs/job?id=88"},{"jobUrl":"http://f1fd28cdfb38:4040/jobs/job?id=89"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1754455203366_2044276616","id":"20250803-112341_2142152289","dateCreated":"2025-08-06T04:40:03+0000","dateStarted":"2025-08-06T05:18:13+0000","dateFinished":"2025-08-06T05:18:14+0000","status":"FINISHED"},{"text":"%md\n#### **Ratings Data**","user":"anonymous","dateUpdated":"2025-08-06T05:18:14+0000","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h4><strong>Ratings Data</strong></h4>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1754455203366_1610791252","id":"20250804-112012_21928383","dateCreated":"2025-08-06T04:40:03+0000","dateStarted":"2025-08-06T05:18:14+0000","dateFinished":"2025-08-06T05:18:14+0000","status":"FINISHED"},{"text":"%pyspark\n\nfrom pyspark.sql import Row\nfrom pyspark.sql import functions as F\n\n# ParseInput Function\ndef parseInput2(line):\n    x = line.split('\\t') # the delimiter use is tab\n    return Row(user_id=int(x[0]), movie_id=int(x[1]), rating=x[2], timestamp=x[3])\n\n# Load raw u.data file\nlines = spark.sparkContext.textFile(\"file:///tmp/u.data\") \n\n# mapping to row\nratings = lines.map(parseInput2)\n\n# Create DataFrame\nratingsDataset = spark.createDataFrame(ratings)\n\n# Write to Cassandra\nratingsDataset.write.format(\"org.apache.spark.sql.cassandra\").mode(\"append\").options(table=\"ratings\", keyspace=\"movielens\").save()\n\n# Read back from Cassandra\nreadRatings = spark.read.format(\"org.apache.spark.sql.cassandra\") \\\n    .options(table=\"ratings\", keyspace=\"movielens\").load()\n\nreadRatings.show()\n","user":"anonymous","dateUpdated":"2025-08-06T05:18:14+0000","progress":100,"config":{"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+--------+------+---------+\n|user_id|movie_id|rating|timestamp|\n+-------+--------+------+---------+\n|    384|     258|     4|891273683|\n|    384|     271|     4|891283502|\n|    384|     272|     5|891273509|\n|    384|     286|     4|891273649|\n|    384|     289|     5|891283502|\n|    384|     300|     4|891273809|\n|    384|     302|     5|891273509|\n|    384|     313|     5|891273683|\n|    384|     316|     5|891274055|\n|    384|     327|     4|891273761|\n|    384|     328|     4|891274091|\n|    384|     329|     3|891273761|\n|    384|     333|     4|891273509|\n|    384|     343|     3|891273716|\n|    384|     347|     4|891273509|\n|    384|     355|     4|891274055|\n|    384|     689|     4|891274232|\n|    384|     748|     4|891274028|\n|    384|     751|     4|891274091|\n|    384|     878|     4|891274962|\n+-------+--------+------+---------+\nonly showing top 20 rows\n\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://f1fd28cdfb38:4040/jobs/job?id=90"},{"jobUrl":"http://f1fd28cdfb38:4040/jobs/job?id=91"},{"jobUrl":"http://f1fd28cdfb38:4040/jobs/job?id=92"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1754455203366_117831732","id":"20250803-112843_1911397722","dateCreated":"2025-08-06T04:40:03+0000","dateStarted":"2025-08-06T05:18:14+0000","dateFinished":"2025-08-06T05:18:15+0000","status":"FINISHED"},{"text":"%md\n#### **Movies data**","user":"anonymous","dateUpdated":"2025-08-06T05:18:15+0000","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h4><strong>Movies data</strong></h4>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1754455203366_594171420","id":"20250804-112009_1985922703","dateCreated":"2025-08-06T04:40:03+0000","dateStarted":"2025-08-06T05:18:15+0000","dateFinished":"2025-08-06T05:18:15+0000","status":"FINISHED"},{"text":"%pyspark\n\nfrom pyspark.sql import Row\nfrom pyspark.sql import functions as F\n\n# ParseInput Function\ndef parseInput3(line):\n    fields = line.split('|') # the delimiter use is pipe\n    return Row(\n        movie_id=int(fields[0]), \n        title=fields[1], \n        release_date=fields[2], \n        imdb_url=fields[4],\n        unknown=int(fields[5]),\n        action=int(fields[6]),\n        adventure=int(fields[7]),\n        animation=int(fields[8]),\n        children=int(fields[9]),\n        comedy=int(fields[10]),\n        crime=int(fields[11]),\n        documentary=int(fields[12]), \n        drama=int(fields[13]),\n        fantasy=int(fields[14]),\n        film_noir=int(fields[15]), \n        horror=int(fields[16]),\n        musical=int(fields[17]),\n        mystery=int(fields[18]),\n        romance=int(fields[19]),\n        sci_fi=int(fields[20]),\n        thriller=int(fields[21]),\n        war=int(fields[22]),\n        western=int(fields[23])\n        );\n        \n\n# Load raw u.item file\nlines = spark.sparkContext.textFile(\"file:///tmp/u.item\") \n\nmovies = lines.map(parseInput3)\nmoviesDataset = spark.createDataFrame(movies)\n\n#write to cassandra\nmoviesDataset.write.format(\"org.apache.spark.sql.cassandra\").mode(\"append\").options(table=\"titles\", keyspace=\"movielens\").save()\n\n#read to check\nreadMovies = spark.read.format(\"org.apache.spark.sql.cassandra\").options(table=\"titles\", keyspace=\"movielens\").load()\n\nreadMovies.show()","user":"anonymous","dateUpdated":"2025-08-06T05:18:15+0000","progress":100,"config":{"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+------+---------+---------+--------+------+-----+-----------+-----+-------+---------+------+--------------------+-------+-------+------------+-------+------+--------+--------------------+-------+---+-------+\n|movie_id|action|adventure|animation|children|comedy|crime|documentary|drama|fantasy|film_noir|horror|            imdb_url|musical|mystery|release_date|romance|sci_fi|thriller|               title|unknown|war|western|\n+--------+------+---------+---------+--------+------+-----+-----------+-----+-------+---------+------+--------------------+-------+-------+------------+-------+------+--------+--------------------+-------+---+-------+\n|    1507|     0|        0|        0|       0|     1|    0|          0|    0|      0|        0|     0|http://us.imdb.co...|      0|      0| 11-Oct-1996|      0|     0|       0|Three Lives and O...|      0|  0|      0|\n|     596|     0|        0|        1|       1|     0|    0|          0|    0|      0|        0|     0|http://us.imdb.co...|      1|      0| 21-Jun-1996|      0|     0|       0|Hunchback of Notr...|      0|  0|      0|\n|    1145|     0|        0|        0|       0|     0|    0|          0|    1|      0|        0|     0|http://us.imdb.co...|      0|      0| 01-Jan-1994|      0|     0|       0|   Blue Chips (1994)|      0|  0|      0|\n|    1609|     0|        0|        0|       0|     1|    0|          0|    0|      0|        0|     0|http://us.imdb.co...|      0|      0| 28-Mar-1997|      0|     0|       0|      B*A*P*S (1997)|      0|  0|      0|\n|    1365|     1|        0|        0|       0|     0|    0|          0|    1|      0|        0|     0|http://us.imdb.co...|      0|      0| 01-Jan-1993|      0|     0|       0|Johnny 100 Pesos ...|      0|  0|      0|\n|    1364|     1|        0|        0|       0|     0|    0|          0|    0|      0|        0|     0|http://us.imdb.co...|      0|      0| 04-Oct-1996|      0|     0|       0| Bird of Prey (1996)|      0|  0|      0|\n|    1418|     0|        0|        0|       0|     0|    0|          0|    1|      0|        0|     0|http://us.imdb.co...|      0|      0| 01-Jan-1993|      0|     0|       0|Joy Luck Club, Th...|      0|  0|      0|\n|     336|     0|        0|        0|       0|     0|    1|          0|    0|      0|        0|     0|http://us.imdb.co...|      0|      0| 01-Jan-1997|      0|     0|       1|  Playing God (1997)|      0|  0|      0|\n|    1557|     0|        0|        0|       0|     1|    0|          0|    1|      0|        0|     0|http://us.imdb.co...|      0|      0| 16-Feb-1996|      0|     0|       0|  Yankee Zulu (1994)|      0|  0|      0|\n|    1164|     0|        0|        0|       1|     0|    0|          0|    0|      0|        0|     0|http://us.imdb.co...|      0|      0| 10-Jan-1997|      0|     0|       0|Zeus and Roxanne ...|      0|  0|      0|\n|      15|     0|        0|        0|       0|     0|    0|          0|    1|      0|        0|     0|http://us.imdb.co...|      0|      0| 29-Jan-1996|      0|     0|       0|Mr. Holland's Opu...|      0|  0|      0|\n|     244|     1|        0|        0|       0|     0|    0|          0|    1|      0|        0|     0|http://us.imdb.co...|      0|      0| 14-Mar-1997|      0|     0|       1|Smilla's Sense of...|      0|  0|      0|\n|     365|     0|        0|        0|       0|     0|    0|          0|    1|      0|        0|     0|http://us.imdb.co...|      0|      0| 01-Jan-1995|      0|     0|       0|       Powder (1995)|      0|  0|      0|\n|     539|     0|        0|        0|       1|     1|    0|          0|    0|      0|        0|     0|http://us.imdb.co...|      0|      0| 01-Jan-1997|      0|     0|       0|   Mouse Hunt (1997)|      0|  0|      0|\n|     410|     0|        0|        0|       0|     1|    0|          0|    0|      0|        0|     0|http://us.imdb.co...|      0|      0| 12-Jul-1996|      0|     0|       0|      Kingpin (1996)|      0|  0|      0|\n|     792|     0|        0|        0|       0|     1|    0|          0|    0|      0|        0|     0|http://us.imdb.co...|      0|      0| 01-Jan-1994|      0|     0|       0|Bullets Over Broa...|      0|  0|      0|\n|    1231|     1|        0|        0|       0|     0|    0|          0|    1|      0|        0|     0|http://us.imdb.co...|      0|      0| 01-Jan-1990|      0|     0|       0|Marked for Death ...|      0|  0|      0|\n|     937|     0|        0|        0|       0|     0|    0|          0|    1|      0|        0|     0|http://us.imdb.co...|      0|      0| 01-Jan-1997|      0|     0|       0|Thousand Acres, A...|      0|  0|      0|\n|     797|     1|        0|        0|       0|     0|    0|          0|    0|      0|        0|     0|http://us.imdb.co...|      0|      0| 01-Jan-1994|      0|     1|       0|      Timecop (1994)|      0|  0|      0|\n|     209|     0|        0|        0|       0|     1|    0|          0|    1|      0|        0|     0|http://us.imdb.co...|      1|      0| 01-Jan-1984|      0|     0|       0|This Is Spinal Ta...|      0|  0|      0|\n+--------+------+---------+---------+--------+------+-----+-----------+-----+-------+---------+------+--------------------+-------+-------+------------+-------+------+--------+--------------------+-------+---+-------+\nonly showing top 20 rows\n\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://f1fd28cdfb38:4040/jobs/job?id=93"},{"jobUrl":"http://f1fd28cdfb38:4040/jobs/job?id=94"},{"jobUrl":"http://f1fd28cdfb38:4040/jobs/job?id=95"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1754455203366_823490184","id":"20250803-113036_989320657","dateCreated":"2025-08-06T04:40:03+0000","dateStarted":"2025-08-06T05:18:15+0000","dateFinished":"2025-08-06T05:18:16+0000","status":"FINISHED"},{"text":"%pyspark\n\n#to allow DF view as SQL\nusersDataset.createOrReplaceTempView(\"users\")\nratingsDataset.createOrReplaceTempView(\"ratings\")\nmoviesDataset.createOrReplaceTempView(\"movies\")","user":"anonymous","dateUpdated":"2025-08-06T05:18:16+0000","progress":0,"config":{"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1754455203366_805942884","id":"20250803-223911_1963812440","dateCreated":"2025-08-06T04:40:03+0000","dateStarted":"2025-08-06T05:18:16+0000","dateFinished":"2025-08-06T05:18:16+0000","status":"FINISHED"},{"text":"%md\n\n### 4. Analysis\n\n#### **a. Average rating for each movie**","user":"anonymous","dateUpdated":"2025-08-06T05:18:16+0000","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>4. Analysis</h3>\n<h4><strong>a. Average rating for each movie</strong></h4>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1754455203367_2040683875","id":"20250803-223909_946231436","dateCreated":"2025-08-06T04:40:03+0000","dateStarted":"2025-08-06T05:18:16+0000","dateFinished":"2025-08-06T05:18:16+0000","status":"FINISHED"},{"text":"%pyspark\n\nfrom pyspark.sql.functions import avg\n\njoined_df = readRatings.join(readMovies, on=\"movie_id\")\navg_ratings = joined_df.groupBy(\"title\").agg(avg(\"rating\").alias(\"avg_rating\"))\n\navg_ratings.limit(20).show()","user":"anonymous","dateUpdated":"2025-08-06T05:18:16+0000","progress":56,"config":{"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+------------------+\n|               title|        avg_rating|\n+--------------------+------------------+\n|         Cosi (1996)|               4.0|\n|       Psycho (1960)| 4.100418410041841|\n| Three Wishes (1995)|3.2222222222222223|\n| If Lucy Fell (1996)|2.7586206896551726|\n|When We Were King...| 4.045454545454546|\n|   Annie Hall (1977)| 3.911111111111111|\n|    Fair Game (1995)|2.1818181818181817|\n|Heavenly Creature...|3.6714285714285713|\n|Paris, France (1993)|2.3333333333333335|\n|Snow White and th...|3.7093023255813953|\n|Night of the Livi...|          3.421875|\n|I'll Do Anything ...|               2.6|\n|Spanking the Monk...| 3.074074074074074|\n|        Mondo (1996)|               3.0|\n|    Threesome (1994)| 2.838709677419355|\n|   Blue Chips (1994)|2.6666666666666665|\n|Colonel Chabert, ...|               3.5|\n|Reality Bites (1994)| 2.961038961038961|\n|A Chef in Love (1...|             4.125|\n|Last Action Hero ...|2.7457627118644066|\n+--------------------+------------------+\n\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://f1fd28cdfb38:4040/jobs/job?id=96"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1754455203367_831018060","id":"20250804-114820_856337022","dateCreated":"2025-08-06T04:40:03+0000","dateStarted":"2025-08-06T05:18:16+0000","dateFinished":"2025-08-06T05:18:19+0000","status":"FINISHED"},{"text":"%md\n\n#### **b. Top ten movies with the highest average ratings**","user":"anonymous","dateUpdated":"2025-08-06T05:18:19+0000","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h4><strong>b. Top ten movies with the highest average ratings</strong></h4>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1754455203367_706881433","id":"20250803-114117_144597852","dateCreated":"2025-08-06T04:40:03+0000","dateStarted":"2025-08-06T05:18:19+0000","dateFinished":"2025-08-06T05:18:19+0000","status":"FINISHED"},{"text":"%pyspark\n\n\ntop10_movies = avg_ratings.orderBy(\"avg_rating\", ascending=False).limit(10)\ntop10_movies.show()","user":"anonymous","dateUpdated":"2025-08-06T05:18:19+0000","progress":61,"config":{"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+----------+\n|               title|avg_rating|\n+--------------------+----------+\n|Someone Else's Am...|       5.0|\n|Saint of Fort Was...|       5.0|\n|Aiqing wansui (1994)|       5.0|\n|Marlene Dietrich:...|       5.0|\n|     Star Kid (1997)|       5.0|\n|Great Day in Harl...|       5.0|\n|Entertaining Ange...|       5.0|\n|They Made Me a Cr...|       5.0|\n|Santa with Muscle...|       5.0|\n|  Prefontaine (1997)|       5.0|\n+--------------------+----------+\n\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://f1fd28cdfb38:4040/jobs/job?id=97"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1754455203368_181233404","id":"20250804-115819_1547755107","dateCreated":"2025-08-06T04:40:03+0000","dateStarted":"2025-08-06T05:18:19+0000","dateFinished":"2025-08-06T05:18:21+0000","status":"FINISHED"},{"text":"%md\n\n#### **c. Users who have rated at least 50 movies and what are their favourite movie genres**\n\n","user":"anonymous","dateUpdated":"2025-08-06T05:18:21+0000","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h4><strong>c. Users who have rated at least 50 movies and what are their favourite movie genres</strong></h4>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1754455203368_1896074680","id":"20250804-114327_1574795137","dateCreated":"2025-08-06T04:40:03+0000","dateStarted":"2025-08-06T05:18:21+0000","dateFinished":"2025-08-06T05:18:21+0000","status":"FINISHED"},{"text":"%sql\n\nWITH active_users AS ( -- filter users who have rated at least 50 movies\n  SELECT user_id\n  FROM ratings\n  GROUP BY user_id\n  HAVING COUNT(*) >= 50\n),\nuser_genres AS ( -- joins ratings with movies to get genre  for each  movie\n  SELECT r.user_id, m.*\n  FROM ratings r\n  JOIN movies m ON r.movie_id = m.movie_id\n  WHERE r.user_id IN (SELECT user_id FROM active_users)\n),\ngenre_counts AS (\n  SELECT user_id, genre, COUNT(*) AS count\n  FROM (\n    SELECT user_id, stack(19, -- to unpivot genre columns to row\n      'unknown', unknown, 'Action', action, 'Adventure', adventure, 'Animation', animation,\n      'Children', children, 'Comedy', comedy, 'Crime', crime, 'Documentary', documentary,\n      'Drama', drama, 'Fantasy', fantasy, 'Film-Noir', film_noir, 'Horror', horror,\n      'Musical', musical, 'Mystery', mystery, 'Romance', romance, 'Sci-Fi', sci_fi,\n      'Thriller', thriller, 'War', war, 'Western', western\n    ) AS (genre, is_genre)\n    FROM user_genres\n  ) g\n  WHERE is_genre = 1 -- the genre is belong to the original genre which 1\n  GROUP BY user_id, genre\n),\nranked_genres AS ( -- to rank genres based on count\n  SELECT *,\n         ROW_NUMBER() OVER (PARTITION BY user_id ORDER BY count DESC) AS rank\n  FROM genre_counts\n)\nSELECT user_id, genre, count\nFROM ranked_genres\nWHERE rank = 1 -- top genre for that user\nORDER BY count DESC\n","user":"anonymous","dateUpdated":"2025-08-06T05:18:21+0000","progress":91,"config":{"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"user_id\tgenre\tcount\n655\tDrama\t410\n405\tDrama\t309\n537\tDrama\t251\n450\tDrama\t237\n13\tDrama\t218\n234\tDrama\t213\n416\tDrama\t212\n279\tComedy\t211\n201\tDrama\t196\n393\tComedy\t191\n181\tDrama\t188\n303\tComedy\t184\n334\tDrama\t174\n90\tDrama\t173\n378\tDrama\t170\n276\tDrama\t168\n429\tDrama\t167\n474\tDrama\t166\n293\tDrama\t165\n308\tDrama\t163\n592\tDrama\t162\n59\tDrama\t162\n846\tDrama\t161\n561\tDrama\t155\n94\tDrama\t155\n880\tComedy\t154\n85\tDrama\t152\n406\tDrama\t151\n269\tDrama\t148\n7\tDrama\t146\n894\tDrama\t146\n707\tDrama\t145\n184\tDrama\t141\n18\tDrama\t141\n642\tComedy\t141\n896\tDrama\t138\n151\tDrama\t137\n682\tDrama\t137\n354\tDrama\t136\n328\tDrama\t135\n916\tDrama\t134\n271\tDrama\t134\n92\tDrama\t133\n747\tDrama\t132\n727\tAction\t132\n222\tComedy\t131\n286\tComedy\t131\n524\tDrama\t130\n796\tDrama\t129\n435\tComedy\t128\n551\tDrama\t128\n535\tDrama\t127\n417\tComedy\t127\n299\tDrama\t126\n194\tDrama\t126\n311\tDrama\t126\n889\tDrama\t125\n345\tDrama\t125\n883\tDrama\t124\n870\tDrama\t124\n385\tDrama\t123\n758\tDrama\t123\n389\tComedy\t120\n130\tAction\t120\n343\tDrama\t119\n268\tComedy\t118\n125\tComedy\t118\n437\tDrama\t117\n144\tDrama\t116\n457\tDrama\t116\n387\tDrama\t116\n305\tDrama\t114\n648\tComedy\t114\n327\tDrama\t113\n87\tComedy\t113\n533\tDrama\t112\n314\tComedy\t111\n425\tAction\t111\n798\tComedy\t110\n339\tDrama\t110\n454\tDrama\t110\n864\tDrama\t109\n62\tDrama\t108\n618\tDrama\t108\n919\tDrama\t108\n711\tDrama\t108\n500\tDrama\t108\n363\tDrama\t108\n1\tDrama\t107\n497\tAction\t107\n854\tDrama\t105\n749\tAction\t105\n804\tComedy\t105\n788\tDrama\t105\n504\tDrama\t104\n224\tDrama\t104\n6\tDrama\t104\n653\tDrama\t103\n399\tDrama\t103\n608\tDrama\t103\n790\tComedy\t103\n666\tDrama\t103\n650\tDrama\t102\n145\tDrama\t102\n342\tDrama\t102\n716\tDrama\t101\n244\tComedy\t101\n102\tAction\t101\n472\tAction\t101\n409\tDrama\t101\n207\tDrama\t100\n336\tComedy\t100\n455\tDrama\t99\n178\tDrama\t99\n301\tComedy\t98\n458\tDrama\t98\n95\tDrama\t97\n833\tDrama\t97\n374\tDrama\t97\n627\tDrama\t96\n312\tDrama\t96\n189\tDrama\t96\n588\tDrama\t95\n456\tDrama\t95\n805\tComedy\t95\n532\tDrama\t95\n639\tDrama\t94\n291\tComedy\t93\n932\tDrama\t92\n486\tDrama\t92\n782\tDrama\t92\n757\tAction\t92\n886\tDrama\t91\n407\tComedy\t91\n660\tAction\t91\n373\tDrama\t90\n174\tComedy\t90\n452\tDrama\t88\n49\tComedy\t88\n807\tAction\t88\n280\tDrama\t87\n43\tComedy\t87\n109\tAction\t87\n503\tDrama\t86\n659\tDrama\t86\n840\tDrama\t85\n313\tDrama\t85\n60\tDrama\t85\n128\tDrama\t85\n721\tDrama\t85\n318\tComedy\t84\n487\tDrama\t84\n774\tAction\t83\n543\tDrama\t83\n514\tDrama\t83\n344\tDrama\t83\n606\tDrama\t83\n881\tComedy\t83\n586\tAction\t83\n11\tDrama\t82\n5\tComedy\t82\n119\tDrama\t82\n158\tAction\t81\n545\tAction\t81\n693\tDrama\t81\n346\tAction\t81\n56\tComedy\t81\n468\tDrama\t81\n10\tDrama\t81\n296\tDrama\t80\n200\tAction\t79\n664\tDrama\t79\n826\tAction\t78\n380\tDrama\t78\n506\tComedy\t78\n527\tDrama\t78\n64\tDrama\t78\n622\tAction\t77\n671\tAction\t77\n712\tComedy\t77\n332\tThriller\t77\n197\tAction\t76\n795\tComedy\t76\n878\tDrama\t76\n239\tDrama\t76\n600\tAction\t75\n320\tAction\t75\n347\tAction\t75\n479\tAction\t75\n643\tComedy\t74\n267\tAction\t74\n83\tComedy\t74\n321\tDrama\t74\n621\tComedy\t74\n295\tDrama\t73\n398\tComedy\t73\n593\tDrama\t73\n868\tComedy\t73\n256\tAction\t73\n394\tAction\t73\n22\tComedy\t72\n567\tDrama\t72\n379\tComedy\t72\n198\tDrama\t72\n116\tDrama\t72\n663\tDrama\t72\n709\tAction\t72\n828\tDrama\t72\n619\tAction\t72\n488\tDrama\t71\n495\tAction\t71\n733\tDrama\t71\n542\tComedy\t71\n933\tComedy\t71\n815\tDrama\t70\n907\tDrama\t70\n498\tDrama\t70\n763\tDrama\t70\n217\tAction\t69\n246\tAction\t69\n892\tComedy\t69\n214\tDrama\t69\n851\tDrama\t69\n476\tComedy\t69\n585\tDrama\t68\n766\tDrama\t68\n694\tDrama\t68\n521\tAction\t68\n934\tDrama\t68\n936\tDrama\t68\n823\tDrama\t68\n484\tAction\t68\n751\tComedy\t68\n548\tThriller\t67\n903\tDrama\t67\n58\tDrama\t67\n72\tDrama\t67\n297\tDrama\t67\n629\tDrama\t66\n738\tAction\t66\n615\tDrama\t66\n566\tDrama\t66\n391\tDrama\t66\n42\tDrama\t66\n21\tThriller\t66\n690\tComedy\t66\n436\tDrama\t65\n715\tAction\t65\n262\tDrama\t64\n577\tComedy\t64\n943\tAction\t64\n401\tDrama\t64\n381\tDrama\t63\n264\tComedy\t63\n624\tDrama\t63\n233\tDrama\t63\n634\tDrama\t63\n843\tDrama\t63\n442\tAction\t62\n325\tDrama\t62\n236\tDrama\t62\n536\tDrama\t62\n326\tDrama\t61\n249\tDrama\t61\n773\tDrama\t61\n862\tDrama\t61\n835\tDrama\t61\n887\tComedy\t61\n645\tDrama\t59\n601\tDrama\t59\n243\tDrama\t59\n463\tDrama\t59\n210\tComedy\t59\n453\tDrama\t59\n705\tAction\t59\n360\tDrama\t58\n82\tDrama\t58\n232\tDrama\t58\n466\tAction\t58\n848\tDrama\t58\n294\tAction\t58\n104\tDrama\t57\n927\tComedy\t57\n897\tAction\t57\n216\tDrama\t57\n847\tComedy\t57\n523\tComedy\t57\n392\tDrama\t57\n213\tDrama\t56\n270\tDrama\t56\n16\tDrama\t56\n901\tComedy\t56\n699\tDrama\t56\n665\tDrama\t55\n493\tAction\t55\n263\tDrama\t55\n23\tDrama\t54\n918\tDrama\t54\n806\tDrama\t54\n152\tComedy\t54\n221\tAction\t54\n290\tAction\t53\n361\tDrama\t53\n445\tDrama\t53\n654\tDrama\t53\n330\tComedy\t53\n913\tDrama\t53\n871\tDrama\t53\n99\tDrama\t53\n496\tDrama\t52\n254\tChildren\t52\n177\tDrama\t52\n316\tDrama\t52\n541\tComedy\t52\n160\tDrama\t51\n44\tDrama\t51\n186\tThriller\t51\n298\tDrama\t51\n110\tAction\t50\n875\tDrama\t50\n684\tComedy\t50\n825\tDrama\t50\n230\tDrama\t50\n37\tAction\t50\n786\tDrama\t49\n638\tAction\t49\n661\tDrama\t49\n605\tDrama\t49\n637\tDrama\t49\n746\tAction\t49\n669\tDrama\t49\n447\tDrama\t48\n940\tDrama\t48\n292\tDrama\t48\n478\tComedy\t48\n235\tDrama\t48\n899\tDrama\t48\n15\tDrama\t48\n70\tAction\t48\n288\tDrama\t48\n591\tComedy\t48\n553\tDrama\t48\n554\tDrama\t48\n397\tDrama\t47\n632\tDrama\t47\n499\tDrama\t47\n922\tComedy\t47\n704\tDrama\t47\n748\tDrama\t47\n122\tDrama\t47\n57\tComedy\t46\n383\tDrama\t46\n863\tDrama\t46\n76\tDrama\t46\n885\tComedy\t46\n65\tDrama\t46\n323\tDrama\t46\n698\tDrama\t46\n617\tHorror\t46\n91\tDrama\t46\n830\tAction\t45\n223\tComedy\t45\n505\tDrama\t45\n764\tDrama\t45\n640\tComedy\t45\n867\tDrama\t45\n882\tComedy\t45\n620\tChildren\t44\n423\tDrama\t44\n460\tDrama\t44\n188\tDrama\t44\n121\tDrama\t43\n159\tComedy\t43\n579\tComedy\t43\n38\tComedy\t43\n275\tAction\t42\n459\tAction\t42\n255\tThriller\t42\n890\tDrama\t42\n877\tDrama\t42\n731\tDrama\t42\n683\tDrama\t42\n921\tComedy\t42\n250\tDrama\t42\n193\tComedy\t42\n63\tDrama\t42\n26\tDrama\t41\n115\tDrama\t41\n449\tDrama\t41\n538\tDrama\t41\n924\tDrama\t41\n568\tDrama\t41\n708\tComedy\t41\n938\tComedy\t40\n257\tDrama\t40\n595\tDrama\t40\n106\tDrama\t40\n710\tDrama\t40\n829\tDrama\t40\n215\tDrama\t40\n630\tDrama\t40\n717\tDrama\t40\n331\tDrama\t40\n195\tDrama\t40\n741\tComedy\t40\n8\tAction\t39\n560\tDrama\t39\n492\tDrama\t39\n14\tDrama\t39\n89\tDrama\t39\n625\tDrama\t39\n307\tAction\t38\n719\tDrama\t38\n489\tDrama\t38\n451\tDrama\t38\n79\tDrama\t38\n860\tDrama\t38\n697\tThriller\t38\n426\tDrama\t37\n658\tDrama\t37\n587\tDrama\t37\n141\tComedy\t37\n539\tDrama\t37\n465\tDrama\t37\n756\tAction\t37\n24\tDrama\t37\n752\tDrama\t36\n283\tComedy\t36\n253\tDrama\t36\n686\tDrama\t36\n176\tDrama\t36\n931\tDrama\t35\n518\tDrama\t35\n422\tDrama\t35\n75\tComedy\t35\n315\tDrama\t35\n911\tComedy\t35\n2\tDrama\t35\n745\tDrama\t35\n610\tDrama\t35\n838\tDrama\t34\n802\tHorror\t34\n724\tDrama\t34\n831\tDrama\t34\n508\tComedy\t33\n372\tThriller\t33\n382\tDrama\t33\n123\tDrama\t33\n559\tDrama\t33\n164\tThriller\t33\n470\tDrama\t33\n552\tComedy\t33\n396\tThriller\t32\n206\tDrama\t32\n844\tAction\t32\n338\tComedy\t32\n526\tDrama\t32\n430\tDrama\t32\n117\tAction\t32\n834\tDrama\t32\n187\tDrama\t31\n942\tDrama\t31\n28\tThriller\t31\n161\tDrama\t31\n73\tDrama\t31\n761\tDrama\t31\n324\tDrama\t31\n100\tDrama\t31\n251\tAction\t31\n776\tHorror\t31\n77\tDrama\t31\n367\tHorror\t31\n54\tThriller\t30\n48\tDrama\t30\n735\tDrama\t30\n52\tDrama\t30\n329\tDrama\t30\n569\tDrama\t30\n507\tAction\t30\n402\tDrama\t29\n365\tDrama\t29\n534\tComedy\t29\n277\tDrama\t29\n501\tDrama\t29\n633\tAction\t29\n753\tDrama\t29\n413\tDrama\t29\n227\tDrama\t29\n183\tAction\t29\n908\tDrama\t29\n113\tDrama\t28\n226\tDrama\t28\n118\tDrama\t28\n135\tThriller\t28\n734\tDrama\t28\n440\tDrama\t28\n821\tDrama\t28\n69\tDrama\t28\n180\tDrama\t28\n370\tDrama\t28\n771\tComedy\t28\n573\tDrama\t28\n480\tDrama\t28\n768\tDrama\t28\n557\tDrama\t28\n540\tDrama\t28\n411\tAction\t27\n676\tComedy\t27\n910\tDrama\t27\n872\tComedy\t27\n562\tDrama\t27\n647\tAction\t27\n357\tComedy\t27\n190\tThriller\t27\n274\tDrama\t27\n770\tDrama\t27\n84\tDrama\t26\n167\tDrama\t26\n25\tComedy\t26\n218\tComedy\t26\n839\tDrama\t26\n787\tDrama\t26\n780\tDrama\t26\n923\tThriller\t26\n481\tComedy\t26\n836\tDrama\t26\n148\tDrama\t25\n101\tComedy\t25\n930\tComedy\t25\n168\tComedy\t25\n490\tDrama\t25\n778\tDrama\t25\n154\tDrama\t25\n138\tDrama\t25\n41\tDrama\t24\n322\tDrama\t24\n248\tAction\t24\n893\tAction\t24\n432\tComedy\t24\n464\tThriller\t24\n421\tThriller\t24\n483\tAction\t24\n12\tDrama\t24\n81\tComedy\t24\n679\tComedy\t24\n395\tDrama\t23\n348\tComedy\t23\n287\tComedy\t23\n546\tAction\t22\n388\tThriller\t22\n412\tDrama\t22\n3\tDrama\t22\n428\tDrama\t22\n272\tDrama\t22\n912\tDrama\t22\n525\tDrama\t22\n97\tDrama\t22\n157\tDrama\t21\n582\tAction\t21\n793\tDrama\t21\n865\tComedy\t21\n555\tComedy\t20\n371\tAction\t20\n850\tComedy\t20\n350\tDrama\t19\n403\tComedy\t18\n96\tDrama\t17\n528\tComedy\t17\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://f1fd28cdfb38:4040/jobs/job?id=98"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1754455203368_410069189","id":"20250804-120059_1423799229","dateCreated":"2025-08-06T04:40:03+0000","dateStarted":"2025-08-06T05:18:21+0000","dateFinished":"2025-08-06T05:18:30+0000","status":"FINISHED"},{"text":"%md\n\n#### **d. Users who are less than 20 years old**\n\n","user":"anonymous","dateUpdated":"2025-08-06T05:18:30+0000","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h4><strong>d. Users who are less than 20 years old</strong></h4>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1754455203368_2062126985","id":"20250804-114445_39647211","dateCreated":"2025-08-06T04:40:03+0000","dateStarted":"2025-08-06T05:18:30+0000","dateFinished":"2025-08-06T05:18:30+0000","status":"FINISHED"},{"text":"%pyspark\n\nunder20age = readUsers.filter(\"age < 20\")\nunder20age.show()\n","user":"anonymous","dateUpdated":"2025-08-06T05:18:30+0000","progress":0,"config":{"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+---+------+-------------+--------+\n|user_id|age|gender|   occupation|zip_code|\n+-------+---+------+-------------+--------+\n|    262| 19|     F|      student|   78264|\n|    142| 13|     M|        other|   48118|\n|    223| 19|     F|      student|   47906|\n|    289| 11|     M|         none|   94619|\n|    618| 15|     F|      student|   44212|\n|    471| 10|     M|      student|   77459|\n|    281| 15|     F|      student|   06059|\n|    621| 17|     M|      student|   60402|\n|    887| 14|     F|      student|   27249|\n|    270| 18|     F|      student|   63119|\n|     36| 19|     F|      student|   93117|\n|    347| 18|     M|      student|   90210|\n|    674| 13|     F|      student|   55337|\n|    375| 17|     M|entertainment|   37777|\n|    880| 13|     M|      student|   83702|\n|    291| 19|     M|      student|   44106|\n|     57| 16|     M|         none|   84010|\n|    609| 13|     F|      student|   55106|\n|    303| 19|     M|      student|   14853|\n|    619| 17|     M|      student|   44134|\n+-------+---+------+-------------+--------+\nonly showing top 20 rows\n\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://f1fd28cdfb38:4040/jobs/job?id=99"},{"jobUrl":"http://f1fd28cdfb38:4040/jobs/job?id=100"},{"jobUrl":"http://f1fd28cdfb38:4040/jobs/job?id=101"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1754455203369_1426086560","id":"20250804-120218_254895312","dateCreated":"2025-08-06T04:40:03+0000","dateStarted":"2025-08-06T05:18:30+0000","dateFinished":"2025-08-06T05:18:30+0000","status":"FINISHED"},{"text":"%md\n#### **e. Users whose occupation is “scientist” and whose age is between 30 and 40 years old**","user":"anonymous","dateUpdated":"2025-08-06T05:18:30+0000","progress":0,"config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h4><strong>e. Users whose occupation is “scientist” and whose age is between 30 and 40 years old</strong></h4>\n\n</div>"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1754455203369_934655887","id":"20250804-114507_1710445547","dateCreated":"2025-08-06T04:40:03+0000","dateStarted":"2025-08-06T05:18:30+0000","dateFinished":"2025-08-06T05:18:30+0000","status":"FINISHED"},{"text":"%sql\n\nSELECT * FROM users\nWHERE occupation = 'scientist' AND age BETWEEN 30 AND 40\n","user":"anonymous","dateUpdated":"2025-08-06T05:18:30+0000","progress":0,"config":{"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"user_id\tage\tgender\toccupation\tzip_code\n40\t38\tM\tscientist\t27514\n71\t39\tM\tscientist\t98034\n74\t39\tM\tscientist\tT8H1N\n107\t39\tM\tscientist\t60466\n183\t33\tM\tscientist\t27708\n272\t33\tM\tscientist\t53706\n309\t40\tM\tscientist\t70802\n337\t37\tM\tscientist\t10522\n430\t38\tM\tscientist\t98199\n538\t31\tM\tscientist\t21010\n543\t33\tM\tscientist\t95123\n554\t32\tM\tscientist\t62901\n643\t39\tM\tscientist\t55122\n730\t31\tF\tscientist\t32114\n874\t36\tM\tscientist\t37076\n918\t40\tM\tscientist\t70116\n"}]},"apps":[],"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":[{"jobUrl":"http://f1fd28cdfb38:4040/jobs/job?id=102"},{"jobUrl":"http://f1fd28cdfb38:4040/jobs/job?id=103"}],"interpreterSettingId":"spark"}},"progressUpdateIntervalMs":500,"jobName":"paragraph_1754455203370_593050152","id":"20250804-120310_1319727395","dateCreated":"2025-08-06T04:40:03+0000","dateStarted":"2025-08-06T05:18:30+0000","dateFinished":"2025-08-06T05:18:31+0000","status":"FINISHED"},{"text":"%pyspark\n\nspark.version","user":"anonymous","dateUpdated":"2025-08-06T05:18:31+0000","progress":0,"config":{"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"'3.1.2'"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1754455203370_40863625","id":"20250804-114511_214210954","dateCreated":"2025-08-06T04:40:03+0000","dateStarted":"2025-08-06T05:18:31+0000","dateFinished":"2025-08-06T05:18:31+0000","status":"FINISHED"},{"text":"%pyspark\n\n\nsc.version","user":"anonymous","dateUpdated":"2025-08-06T05:18:31+0000","progress":0,"config":{"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"'3.1.2'"}]},"apps":[],"runtimeInfos":{},"progressUpdateIntervalMs":500,"jobName":"paragraph_1754455203370_901801007","id":"20250804-122825_1565930194","dateCreated":"2025-08-06T04:40:03+0000","dateStarted":"2025-08-06T05:18:31+0000","dateFinished":"2025-08-06T05:18:31+0000","status":"FINISHED"}],"name":"A3_P153870","id":"2M3FHS3UY","defaultInterpreterGroup":"spark","version":"0.12.0","noteParams":{},"noteForms":{},"angularObjects":{},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{},"path":"/A3_P153870"}